#!/bin/bash
# SLURM job for TinyZero vanilla baseline (fixed window)

#SBATCH --job-name=tinyzero_vanilla
#SBATCH --partition=gpu_a100
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --gres=gpu:4
#SBATCH --cpus-per-task=36
#SBATCH --mem=240G
#SBATCH --time=04:00:00

set -euo pipefail

module purge
module load 2023
module load CUDA/12.4.0
module load Anaconda3/2023.07-2

source activate verl

export DATA_DIR=${DATA_DIR:-$PWD}
export BASE_MODEL=${BASE_MODEL:-~/models/deepseek-llm-7b-chat}
export N_GPUS=${N_GPUS:-4}
export ROLLOUT_TP_SIZE=${ROLLOUT_TP_SIZE:-2}
export EXPERIMENT_NAME=${EXPERIMENT_NAME:-tinyzero_vanilla}

bash scripts/train_tiny_zero_vanilla.sh


